---
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "../lib/shadcn-imports";
import { Badge } from "../lib/shadcn-imports";
import { Star } from "../lib/shadcn-imports";

/**
 * Estructura de un testimonio
 */
type Testimonial = {
  name: string;
  role: string;
  color: "gold" | "jade" | "blue-gray";
  text: string;
  delay: string;
};

// Testimonios en array para escalabilidad y limpieza
const testimonials: Testimonial[] = [
  {
    name: "Carlos Mendoza",
    role: "Full-Stack · Bogotá",
    color: "gold",
    text: `"Legato ha transformado mi flujo de trabajo. Documentación automática y contratos impecables con revisión legal por IA."`,
    delay: "",
  },
  {
    name: "Ana López",
    role: "Backend · Medellín",
    color: "jade",
    text: `"Contratos profesionales adaptados a legislación colombiana. El envío automático por WhatsApp es perfecto."`,
    delay: "delay-100",
  },
  {
    name: "Juan Pérez",
    role: "Mobile · Cali",
    color: "blue-gray",
    text: `"Dashboard con estadísticas claras que me ayudan a optimizar tarifas y tomar decisiones informadas sobre mi negocio."`,
    delay: "delay-200",
  },
  {
    name: "María García",
    role: "Frontend · Barranquilla",
    color: "gold",
    text: `"Todo automatizado y profesional. Odio los papeleos y Legato los elimina por completo. Clientes impresionados."`,
    delay: "delay-100",
  },
  {
    name: "Diego Ruiz",
    role: "Architect · Bucaramanga",
    color: "jade",
    text: `"IA para documentación espectacular. Diagramas y requisitos en minutos. Antes tardaba días en documentación técnica."`,
    delay: "delay-200",
  },
  {
    name: "Laura Torres",
    role: "DevOps · Cartagena",
    color: "blue-gray",
    text: `"Escalé mi negocio freelance gracias a Legato. Más proyectos sin sacrificar calidad. Billing excelente."`,
    delay: "delay-300",
  },
];

/**
 * Agrupa un array en subarrays de tamaño fijo
 */
function chunk<T>(arr: T[], size: number): T[][] {
  return Array.from({ length: Math.ceil(arr.length / size) }, (_, i) =>
    arr.slice(i * size, i * size + size)
  );
}
---

<section class="py-32 px-8 md:px-16 bg-primary-black text-primary">
  <div class="max-w-7xl mx-auto">
    <!-- Section header -->
    <div class="mb-24 space-y-6 lazy-appear fade-up">
      <div class="flex items-center gap-4">
        <div class="jp-dot"></div>
        <span class="text-xs text-muted font-light tracking-widest uppercase"
          >Testimonios</span
        >
      </div>
      <h2
        class="text-5xl md:text-6xl font-extralight text-primary jp-title max-w-3xl"
      >
        Experiencias reales
      </h2>
      <div class="w-32 h-px bg-gold/40"></div>
    </div>

    <!-- Testimonials grid: filas de 3, alineados horizontalmente, responsivo y equilibrado -->
    <div class="flex flex-col gap-16">
      {chunk(testimonials, 3).map((row: Testimonial[], rowIdx: number) => (
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          {row.map((t: Testimonial) => (
            <div
              class={`space-y-8 group lazy-appear fade-up ${t.delay} transition-all duration-700 ease-in-out hover:scale-[1.03] hover:shadow-2xl hover:bg-main/80 rounded-2xl p-8 outline-none focus-visible:ring-2 focus-visible:ring-jade/60`}
              tabindex="0"
              aria-label={`Testimonio de ${t.name}`}
            >
              <div class="flex gap-1 justify-center">
                {
                  Array.from({ length: 5 }).map((_, i) => (
                    <Star
                      className={`w-3 h-3 fill-${t.color}/70 text-${t.color}/70 opacity-60 group-hover:opacity-100 transition-opacity`}
                      client:load
                    />
                  ))
                }
              </div>
              <p class="text-sm text-muted/80 font-light leading-loose text-center">
                {t.text}
              </p>
              <div class="space-y-2 text-center">
                <div class="font-light text-primary text-base">{t.name}</div>
                <div class="text-xs text-muted/60 tracking-wider">{t.role}</div>
              </div>
              <div class={`w-12 h-px bg-${t.color}/20 mx-auto`}></div>
            </div>
          ))}
        </div>
      ))}
    </div>
  </div>
</section>
